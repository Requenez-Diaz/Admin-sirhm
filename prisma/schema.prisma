generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int            @id @default(autoincrement())
  email        String         @unique
  username     String         @unique
  password     String
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  roleName     String
  image        String?
  Comments     Comments[]
  reservations Reservation[]
  role         Role           @relation(fields: [roleName], references: [roleName])
  UserImage    UserImage?
  testimonials testimonials[]
}

model Role {
  id       Int    @id @default(autoincrement())
  descript String
  roleName String @unique
  users    User[]
}

model Reservation {
  id            Int      @id @default(autoincrement())
  name          String
  lastName      String
  email         String
  bedroomsType  String
  guests        Int
  rooms         Int
  arrivalDate   DateTime
  departureDate DateTime
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  status        Status
  userId        Int
  user          User     @relation(fields: [userId], references: [id])
}

model testimonials {
  id        Int       @id @default(autoincrement())
  name      String
  avatar    String
  comment   String
  location  String
  rating    Int
  roomType  String
  stayDate  DateTime
  createdAt DateTime  @default(now())
  updatedAt DateTime
  bedroomId Int?
  userId    Int?
  Bedrooms  Bedrooms? @relation(fields: [bedroomId], references: [id])
  User      User?     @relation(fields: [userId], references: [id])
}

model historicReservations {
  id          Int         @id @default(autoincrement())
  bookingId   Int
  events      EventStatus
  description String
  date        DateTime
}

model Services {
  id          String             @id @default(uuid())
  nameService String
  description String
  price       Int
  bookings    bookingsServices[]
}

model Seasons {
  id         Int          @id @default(autoincrement())
  nameSeason String
  dateStart  DateTime
  dateEnd    DateTime
  Bedrooms   Bedrooms[]
  Promotions Promotions[]
}

model bookingsServices {
  id         String    @id @default(uuid())
  bookingId  Int
  serviceId  Int
  price      Int
  servicesId String?
  services   Services? @relation(fields: [servicesId], references: [id])
}

model BookingsDetails {
  id           Int        @id @default(autoincrement())
  bookingId    Int
  bedroomId    Int
  price        Int
  dateStart    DateTime
  dateEnd      DateTime
  promotionId  Int
  status       Status
  created_at   DateTime   @default(now())
  bookingsId   Int
  bedroomsId   Int
  promotionsId Int
  bedrooms     Bedrooms   @relation(fields: [bedroomsId], references: [id])
  Promotions   Promotions @relation(fields: [promotionsId], references: [id])
}

model Invoce {
  id            Int             @id @default(autoincrement())
  clientId      Int
  date          DateTime
  invoceDetails invoceDetails[]
}

model invoceDetails {
  id       Int    @id @default(autoincrement())
  invoceId Int
  item     String
  price    Int
  amount   Int
  invoce   Invoce @relation(fields: [invoceId], references: [id])
}

model Bedrooms {
  id              Int      @id @default(autoincrement())
  typeBedroom     String
  description     String
  lowSeasonPrice  Int
  highSeasonPrice Int
  status          Boolean
  numberBedroom   Int
  seasonsId       Int
  amenities       String[]
  capacity        Int
  image           String
  Seasons         Seasons  @relation(fields: [seasonsId], references: [id], onDelete: Cascade)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  BedroomsPromotions BedroomsPromotions[]
  bookingsDetails    BookingsDetails[]
  Comments           Comments[]
  testimonials       testimonials[]
}

model Comments {
  id         Int       @id @default(autoincrement())
  comments   String
  bedroomsId Int?
  content    String
  createdAt  DateTime  @default(now())
  rating     Int       @default(0)
  updatedAt  DateTime
  userId     Int
  Bedrooms   Bedrooms? @relation(fields: [bedroomsId], references: [id])
  User       User      @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Events {
  id         Int      @id @default(autoincrement())
  nameEvents String
  date       DateTime
  hours      DateTime
  location   String
}

model UsersRole {
  Id_user Int @unique
  Id_role Int
}

model UserImage {
  id     Int    @id @default(autoincrement())
  userId Int    @unique
  image  String
  User   User   @relation(fields: [userId], references: [id])
}

model Promotions {
  id                 Int                  @id @default(autoincrement())
  codePromotions     String
  porcentageDescuent Int
  dateStart          DateTime
  dateEnd            DateTime
  description        String
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt
  seasonId           Int
  BedroomsPromotions BedroomsPromotions[]
  bookingsDetails    BookingsDetails[]
  seasons            Seasons              @relation(fields: [seasonId], references: [id])
}

model BedroomsPromotions {
  id          Int        @id @default(autoincrement())
  bedroomId   Int
  promotionId Int
  bedroom     Bedrooms   @relation(fields: [bedroomId], references: [id])
  promotion   Promotions @relation(fields: [promotionId], references: [id])

  @@unique([bedroomId, promotionId])
}

enum BookingsStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

enum EventStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

enum Status {
  PENDING
  CONFIRMED
  CANCELLED
}
